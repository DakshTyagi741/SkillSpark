import re
import json

def extract_keywords(nl_query):
    # Define a set of stopwords to ignore
    stopwords = {"the", "is", "at", "which", "on", "and", "a", "an", "find", "documents", "about"}
    # Extract words and filter out stopwords
    words = re.findall(r'\b\w+\b', nl_query.lower())
    keywords = [word for word in words if word not in stopwords]
    return keywords

def natural_language_to_es_query(nl_query):
    keywords = extract_keywords(nl_query)
    # Construct an Elasticsearch query with the extracted keywords
    es_query = {
        "query": {
            "bool": {
                "should": [
                    {"match": {"content": keyword}} for keyword in keywords
                ]
            }
        }
    }
    return es_query

if __name__ == "__main__":
    nl_query = "Find documents about natural language processing"
    es_query = natural_language_to_es_query(nl_query)
    # Convert the query to a JSON string
    es_query_json = json.dumps(es_query, indent=2)
    print(es_query_json)
